# DataRobot AutoML Operations Agent - Project Design Document

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€DataRobotã®AutoMLæ©Ÿèƒ½ã‚„MLOpsæ©Ÿèƒ½ã‚’è‡ªç„¶è¨€èªã§æ“ä½œã™ã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­è¨ˆãŠã‚ˆã³å®Ÿè£…æŒ‡é‡ã‚’å®šç¾©ã—ã¾ã™ã€‚é–‹ç™ºã«ã‚ãŸã£ã¦ã¯ã€`copilot-instructions.md` ã«è¨˜è¼‰ã•ã‚ŒãŸåˆ¶ç´„ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’å³å®ˆã—ã¦ãã ã•ã„ã€‚

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒãƒ£ãƒƒãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’é€šã˜ã¦è‡ªç„¶è¨€èªã§æŒ‡ç¤ºã‚’å‡ºã—ã€DataRobotã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ï¼ˆãƒ‡ãƒ¼ã‚¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã€äºˆæ¸¬ã€ç›£è¦–ï¼‰ã‚’è‡ªå‹•åŒ–ãƒ»æ“ä½œã§ãã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

**ä¸»è¦ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹**:
- ãƒ¢ãƒ‡ãƒ«ç²¾åº¦ãƒ»ã‚¤ãƒ³ã‚µã‚¤ãƒˆã®å¯¾è©±å½¢å¼ã§ã®ç†è§£
- ç‰¹å¾´é‡é‡è¦åº¦ï¼ˆFeature Impactï¼‰ã®å¯è¦–åŒ–ã¨è§£é‡ˆ
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ»ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã®æ¤œç´¢ã¨ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- äºˆæ¸¬å®Ÿè¡Œã¨ãã®çµæœã®èª¬æ˜

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
* **Orchestration**: LangGraph (`langgraph.graph.StateGraph`)
* **Backend**: Python 3.10+, FastAPI
* **AI Integration**: `datarobot_genai` (LLM Gatewayåˆ©ç”¨)
* **Tools**: Model Context Protocol (MCP) Server
* **Frontend**: React, TypeScript (Plain text input)

## 2. ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### 2.1 ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³: ReAct + MCP Integration
`copilot-instructions.md` ã®æ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¾“ã„ã€**ReActãƒ‘ã‚¿ãƒ¼ãƒ³**ã‚’æ¡ç”¨ã—ã¾ã™ã€‚DataRobot LLM Gateway ã¨ MCPãƒ„ãƒ¼ãƒ«ã‚’çµ±åˆã—ã€LLMãŒè‡ªå¾‹çš„ã«ãƒ„ãƒ¼ãƒ«ã‚’é¸æŠãƒ»å®Ÿè¡Œã™ã‚‹æ§‹æˆã¨ã—ã¾ã™ã€‚

* **Graph Type**: `StateGraph[MessagesState, None, MessagesState, MessagesState](MessagesState)`
    * **é‡è¦**: DataRobotç’°å¢ƒã§ã®äº’æ›æ€§ã‚’ä¿ã¤ãŸã‚ã€å¿…ãšæ¨™æº–ã® `MessagesState` ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã‚«ã‚¹ã‚¿ãƒ Stateã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚
* **Agent Construction**: `create_react_agent` ã‚’ä½¿ç”¨ã—ã¦æ§‹ç¯‰ã—ã¾ã™ã€‚

### 2.2 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

#### å…¥åŠ› (Frontend -> Agent)
* **åˆ¶ç´„**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ã¯**å¿…ãšãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ï¼ˆè‡ªç„¶è¨€èªï¼‰ã‚’é€ä¿¡ã—ã¾ã™ã€‚
* **DRUMåˆ¶ç´„**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®èµ·å‹•ï¼ˆ`invoke`ï¼‰ã¯å˜ä¸€ã®å¼•æ•°ã®ã¿ã‚’å—ã‘å–ã‚‹å®Ÿè£…ã¨ã—ã¾ã™ã€‚
    * âœ… Good: `invoke({"input": "åŒ»ç™‚è²»ãƒ‡ãƒ¼ã‚¿ã®åˆ†æã‚’é–‹å§‹ã—ã¦"})`
    * âŒ Bad: `invoke(target="cost", dataset="medical.csv")`

#### å‡ºåŠ› (Agent -> Frontend)
* **åŸºæœ¬**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ€è€ƒãƒ—ãƒ­ã‚»ã‚¹ã¨ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œçµæœã‚’å«ã‚€è‡ªç„¶è¨€èªã€‚
* **æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿**: ãƒªã‚¹ãƒˆã‚„è¡¨å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ãªå ´åˆã¯ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§JSONå½¢å¼ã§ã®å‡ºåŠ›ã‚’æŒ‡ç¤ºã—ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã§ãƒ‘ãƒ¼ã‚¹ã—ã¦è¡¨ç¤ºã—ã¾ã™ã€‚

## 3. ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆï¼ˆé‡è¦ï¼‰

### 3.1 ãƒ„ãƒ¼ãƒ«ä½¿ç”¨ã®å¼·åˆ¶ãƒ«ãƒ¼ãƒ«

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã€ŒçŸ¥è­˜ã€ã§å›ç­”ã—ã¦ã—ã¾ã†å•é¡Œã‚’é˜²ããŸã‚ã€ä»¥ä¸‹ã®ãƒ«ãƒ¼ãƒ«ã‚’ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«æ˜è¨˜:

```
## ğŸš¨ æœ€é‡è¦ãƒ«ãƒ¼ãƒ«ï¼ˆçµ¶å¯¾å³å®ˆï¼‰

### ãƒ„ãƒ¼ãƒ«ä½¿ç”¨ã®å¼·åˆ¶
1. **æƒ…å ±ã‚’æ±‚ã‚ã‚‰ã‚ŒãŸã‚‰å¿…ãšãƒ„ãƒ¼ãƒ«ã‚’å‘¼ã³å‡ºã™** - çŸ¥è­˜ã‚„æ¨æ¸¬ã§å›ç­”ã—ã¦ã¯ãªã‚‰ãªã„
2. **ãƒ„ãƒ¼ãƒ«ã®å®Ÿè¡Œçµæœã®ã¿ã«åŸºã¥ã„ã¦å›ç­”ã™ã‚‹** - å¤–éƒ¨çŸ¥è­˜ã‚’æ··ãœãªã„
3. **å¤–éƒ¨ãƒªãƒ³ã‚¯ï¼ˆKaggleã€å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç­‰ï¼‰ã‚’å«ã‚ã¦ã¯ãªã‚‰ãªã„**

### ç¦æ­¢äº‹é …
- âŒ ã€Œä¸€èˆ¬çš„ã«ã€œã€ã€Œé€šå¸¸ã¯ã€œã€ã¨ã„ã†æ¨æ¸¬çš„ãªå›ç­”
- âŒ å¤–éƒ¨URLï¼ˆhttps://docs.datarobot.com, https://kaggle.com ç­‰ï¼‰ã®å¼•ç”¨
- âŒ ãƒ„ãƒ¼ãƒ«ã‚’å‘¼ã°ãšã«ã€Œç’°å¢ƒã«ã¯ã€œãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€ã¨ç­”ãˆã‚‹ã“ã¨
```

### 3.2 ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹åˆ¥ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå• | å®Ÿè¡Œã™ã¹ããƒ„ãƒ¼ãƒ« | æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ |
|--------------|-----------------|---------------|
| ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ã‚’è¦‹ã›ã¦ã€ | `list_projects` | ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ â†’ çµæœã‚’ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º |
| ã€Œãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ã‚’æ•™ãˆã¦ã€ | `list_models` â†’ `get_best_model` | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç¢ºèª â†’ ç²¾åº¦æŒ‡æ¨™è¡¨ç¤º |
| ã€Œç‰¹å¾´é‡é‡è¦åº¦ã‚’è¦‹ã›ã¦ã€ | `get_model_feature_impact` | JSONå½¢å¼ã§å‡ºåŠ› â†’ ãƒ•ãƒ­ãƒ³ãƒˆã§ã‚°ãƒ©ãƒ•è¡¨ç¤º |
| ã€Œãƒ¢ãƒ‡ãƒ«ã‚’æ¯”è¼ƒã—ãŸã„ã€ | `list_models` | æ¯”è¼ƒè¡¨ã‚’ç”Ÿæˆ |

## 4. å®Ÿè£…è©³ç´°

### 4.1 ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾© (`agent/agent/myagent.py`)

```python
from langgraph.prebuilt import create_react_agent
from langgraph.graph import StateGraph, MessagesState, START, END
from datarobot_genai.langgraph.agent import LangGraphAgent
from datarobot_genai.core.agents import make_system_prompt

class MyAgent(LangGraphAgent):
    @property
    def workflow(self) -> StateGraph[MessagesState]:
        workflow = StateGraph[MessagesState, None, MessagesState, MessagesState](MessagesState)
        workflow.add_node("agent", self.agent)
        workflow.add_edge(START, "agent")
        workflow.add_edge("agent", END)
        return workflow

    @property
    def agent(self):
        return create_react_agent(
            self.llm(preferred_model="datarobot/azure/gpt-4o-2024-11-20"), 
            tools=self.mcp_tools,
            prompt=make_system_prompt(DATAROBOT_EXPERT_PROMPT),
            name="DataRobot Expert Agent",
        )
```

### 4.2 åˆ©ç”¨å¯èƒ½ãªMCPãƒ„ãƒ¼ãƒ«ï¼ˆ29å€‹ï¼‰

| ã‚«ãƒ†ã‚´ãƒª | ãƒ„ãƒ¼ãƒ«å | ç”¨é€” |
|---------|---------|------|
| **ãƒ‡ãƒ¼ã‚¿ç®¡ç†** | `list_ai_catalog_items`, `upload_dataset_to_ai_catalog`, `analyze_dataset` | ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæ“ä½œ |
| **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ** | `list_projects`, `get_project_dataset_by_name`, `start_autopilot` | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç† |
| **ãƒ¢ãƒ‡ãƒ«** | `list_models`, `get_best_model`, `score_dataset_with_model` | ãƒ¢ãƒ‡ãƒ«ç®¡ç† |
| **ã‚¤ãƒ³ã‚µã‚¤ãƒˆ** | `get_model_feature_impact`, `get_model_roc_curve`, `get_model_lift_chart` | ãƒ¢ãƒ‡ãƒ«åˆ†æ |
| **ãƒ‡ãƒ—ãƒ­ã‚¤** | `list_deployments`, `get_deployment_info`, `deploy_model` | æœ¬ç•ªç’°å¢ƒç®¡ç† |
| **äºˆæ¸¬** | `predict_realtime`, `predict_by_ai_catalog`, `validate_prediction_data` | äºˆæ¸¬å®Ÿè¡Œ |

## 5. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­è¨ˆ

### 5.1 ã‚¤ãƒ³ã‚µã‚¤ãƒˆå¯è¦–åŒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

`frontend_web/src/components/insights/` ã«ä»¥ä¸‹ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®Ÿè£…:

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | ç”¨é€” | ãƒˆãƒªã‚¬ãƒ¼ |
|---------------|------|---------|
| `FeatureImpactChart` | ç‰¹å¾´é‡é‡è¦åº¦ã®æ¨ªæ£’ã‚°ãƒ©ãƒ• | `type: "feature_impact"` |
| `ModelMetricsCard` | ç²¾åº¦æŒ‡æ¨™ï¼ˆAUC, Accuracyç­‰ï¼‰ã®è¡¨ç¤º | `type: "model_metrics"` |
| `ProjectListTable` | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ï¼ˆæ¤œç´¢ãƒ»ã‚½ãƒ¼ãƒˆä»˜ãï¼‰ | `type: "project_list"` |
| `ModelComparisonTable` | ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒè¡¨ | `type: "model_comparison"` |
| `InsightRenderer` | JSONè‡ªå‹•æ¤œå‡ºãƒ»é©åˆ‡ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé¸æŠ | è‡ªå‹• |

### 5.2 JSONå‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™éš›ã®JSONå½¢å¼:

```json
{
  "type": "feature_impact",
  "modelName": "XGBoost Classifier",
  "data": [
    {"feature": "income", "impact": 0.85},
    {"feature": "age", "impact": 0.72}
  ]
}
```

```json
{
  "type": "project_list",
  "projects": [
    {
      "id": "abc123",
      "name": "LendingClub Analysis",
      "updated": "2025-12-24T15:46:00Z",
      "targetVariable": "loan_default",
      "status": "completed"
    }
  ]
}
```

### 5.3 ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 

* **ã‚«ãƒ©ãƒ¼**: ã‚­ãƒ¼ã‚«ãƒ©ãƒ¼ `#81FBA5`ã€ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒ (`bg-gray-900`) åŸºæœ¬
* **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£**: WCAG AAåŸºæº–ï¼ˆã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆæ¯” 4.5:1ï¼‰

## 6. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### 6.1 å¿…è¦ãªãƒãƒ¼ãƒˆ

| ã‚µãƒ¼ãƒ“ã‚¹ | ãƒãƒ¼ãƒˆ | ç”¨é€” |
|---------|--------|------|
| FastAPI | 8080 | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API |
| Vite | 5173 | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ |
| Agent | 8842 | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚µãƒ¼ãƒãƒ¼ |

### 6.2 MCPè¨­å®š

å¤–éƒ¨MCPã‚µãƒ¼ãƒãƒ¼ï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿ï¼‰ã‚’ä½¿ç”¨:
- **MCP Deployment ID**: `691547543ecd350a6039263c`
- `MCP_SERVER_REGISTER_DYNAMIC_TOOLS_ON_STARTUP` â†’ `false`
- `MCP_SERVER_REGISTER_DYNAMIC_PROMPTS_ON_STARTUP` â†’ `false`

## 7. ãƒ†ã‚¹ãƒˆæ–¹æ³•

### 7.1 æ¨å¥¨ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

```
# åŸºæœ¬å‹•ä½œç¢ºèª
ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ã‚’è¦‹ã›ã¦ã€
â†’ list_projects ãƒ„ãƒ¼ãƒ«ãŒå‘¼ã°ã‚Œã€ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§è¡¨ç¤ºã•ã‚Œã‚‹ã¹ã

# ãƒ¢ãƒ‡ãƒ«ç²¾åº¦ç¢ºèª
ã€ŒLendingClub ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¢ãƒ‡ãƒ«ç²¾åº¦ã‚’æ•™ãˆã¦ã€
â†’ list_models, get_best_model ãŒå‘¼ã°ã‚Œã€ç²¾åº¦æŒ‡æ¨™ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¹ã

# ç‰¹å¾´é‡é‡è¦åº¦
ã€Œæœ€è‰¯ãƒ¢ãƒ‡ãƒ«ã®ç‰¹å¾´é‡é‡è¦åº¦ã‚’è¦‹ã›ã¦ã€
â†’ get_model_feature_impact ãŒå‘¼ã°ã‚Œã€ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¹ã

# ç¦æ­¢å‹•ä½œç¢ºèª
â†’ å¤–éƒ¨ãƒªãƒ³ã‚¯ï¼ˆKaggleã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç­‰ï¼‰ãŒå«ã¾ã‚Œã¦ã„ãªã„ã“ã¨
â†’ ã€Œä¸€èˆ¬çš„ã«ã€œã€ã¨ã„ã†æ¨æ¸¬çš„å›ç­”ãŒãªã„ã“ã¨
```

### 7.2 ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ

```bash
# å…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆèµ·å‹•
task dev

# ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå˜ä½“ãƒ†ã‚¹ãƒˆ
task agent:cli START_DEV=1 -- execute --user_prompt 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ã‚’è¦‹ã›ã¦'
```